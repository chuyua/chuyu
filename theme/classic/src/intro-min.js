async function get_posts_content(e,t){let n={};return await fetch(e.url).then(e=>e.text()).then(e=>(n.preview={response:e},n.preview.mdcontent=markdownrender(e),markdownrender(e))).then(e=>{document.getElementsByClassName("none")[0].innerHTML=e,imgs=document.getElementsByClassName("none")[0].getElementsByTagName("img");for(let e=0;e<imgs.length;e++)imgs[e].src=""}).then((function(){n.preview.title=document.getElementsByClassName("none")[0].getElementsByTagName("h1")[0].innerText,n.preview.intro=config.post[t].introduction})).then((function(){return"?page=archive"===window.location.search?n.container='<div class="post-container"><a href="?p='+config.post[t].url+'"><h1>'+n.preview.title+'</h1></a><div class="post-time margin-bottom"><i class="material-icons date_range"></i>'+loadtime(config.post[t].url).posttime+"</div></div>":n.container='<div class="post-container"><h1>'+n.preview.title+'</h1><p class="post-intro">'+n.preview.intro+'</p><div class="post-time"><i class="material-icons date_range"></i>'+loadtime(config.post[t].url).posttime+'</div><div class="post-tags">'+createtags(config.post[t].url).innerHTML+'</div><p><a href="?p='+config.post[t].url+'">Reading<i class="material-icons arrow_forward"></i></a></p></div>',n.container})).then(e=>{document.getElementById("post").innerHTML+=e}).then((function(){document.getElementsByClassName("none")[0].innerHTML=""})),""}async function init_post_container(){var e="";for(let t=0;t<config.post.length;t++){const n={};n.url=settings.post+config.post[t].url+".md",e+=get_posts_content(n,t)}return e}document.getElementById("avatar").src=config.theme_config.avatar,document.getElementById("intro-text-title").innerHTML=config.theme_config.author+"'s Blog",document.getElementById("intro-text-intro").innerHTML="—— "+config.theme_config.introduction;var search=async()=>{var e="";document.getElementById("tag").append(createtag([decodeURI(getpar("tag"))])),getpar("tag")||(window.location.href=settings.domain);try{checktags([decodeURI(getpar("tag"))])}catch{document.querySelector("#tags").innerHTML="<h1>Tags Not Found</h1>"}0==checktags([decodeURI(getpar("tag"))])&&(document.querySelector("#tags").innerHTML="<h1>Tags Not Found</h1>");let t=checktags([decodeURI(getpar("tag"))]);for(let n=0;n<config.post.length;n++)for(let o in t)if(config.post[n].url===t[o]){const t={};t.url=settings.post+config.post[n].url+".md",e+=get_posts_content(t,n);break}return e};async function init_plugins(){blogging_info("Load Plugin who loadtime = themerender");for(let e in config.plugins)if("themerender"===config.plugins[e].loadtime){blogging_info("Load "+config.plugins[e].name+" with defer enabled "+config.plugins[e].defer);for(let t in config.plugins[e].depend){let n=document.createElement("script");n.src=config.plugins[e].depend[t],await document.head.appendChild(n)}let t=document.createElement("script");t.src=config.plugins[e].script,config.plugins[e].deferS&&(t.defer=!0),document.head.append(t)}setTimeout(()=>{blogging_info("plugins load finish")},1)}function loadcomments(){if(config.comment.enable){blogging_info("Start load comment");for(let e in comment.depend.js)a=document.createElement("script"),a.src=comment.depend.js[e],document.getElementById("jscomments").append(a);a=document.createElement("script"),a.src=settings.domain+"src/js/"+comment.load,a.defer="defer",document.getElementById("jscomments").append(a)}}var loadtime=e=>{for(let t in config.post)if(e===config.post[t].url)return{postunixtimestamp:Math.round(config.post[t].time/1e3),posttime:new Date(Math.round(config.post[t].time)).toLocaleString(),nowtime:(new Date).toLocaleString()}},gettime=e=>{let t=document.createElement("div"),n=document.createElement("i");return n.classList="material-icons date_range",t.append(n),t.classList="posttime",t.innerHTML+=loadtime(e).posttime,t};function config_page(){var e=document.getElementsByTagName("img");for(let t=0;t<e.length;t++)e[t].loading="lazy";let t=document.createElement("link");t.rel="shortcut icon",t.href=config.theme_config.avatar,document.head.append(t)}async function init_post(){document.getElementById("func").append(gettime(getpar("p"))),document.getElementById("func").append(createtags(getpar("p")))}var createtags=e=>{let t=gettags(e);return createtag(t)},createtag=e=>{let t=[],n=document.createElement("div");n.classList="tags-container";for(let o in e)t[o]=document.createElement("a"),t[o].classList="tags-tags",t[o].innerHTML="<i class='material-icons i-1'>label</i>"+e[o],t[o].href="?page=tags&tag="+e[o],n.append(t[o]);return n},checktags=e=>{let t=[];for(let n in e)for(let o in config.post)if(null!==gettags(config.post[o].url).toString().match(e[n]))for(let i in gettags(config.post[o].url))gettags(config.post[o].url)[i]===e[n]&&t.push(config.post[o].url);return t},gettags=e=>{for(let t in config.post)if(e===config.post[t].url)return config.post[t].tags};if("tags"!=getpar("page")&&getpar("page"))init_plugins(),config_page(),init_post_container();else if(getpar("p")){let e=!0;e&&document.getElementById("comments").getBoundingClientRect().top<=1300&&(loadcomments(),e=!1,document.onscroll=function(){}),document.onscroll=function(){e&&document.getElementById("comments").getBoundingClientRect().top<=1300&&(loadcomments(),e=!1,document.onscroll=function(){})},init_plugins(),config_page(),init_post()}else"tags"===getpar("page")&&(init_plugins(),config_page(),search());document.getElementById("des").content=config.theme_config.introduction;